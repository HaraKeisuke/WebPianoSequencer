(window.webpackJsonppiano=window.webpackJsonppiano||[]).push([[0],{27:function(e,t,n){e.exports=n(63)},62:function(e,t,n){},63:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n(19),c=n(3),r=n(1),o=n(2),s=n(6),u=n(5),l=n(7),h=n(4),p=n(20),v=n.n(p),f=function(){function e(){Object(r.a)(this,e),this.ctx=new d.AudioContext,this.piano=void 0}return Object(o.a)(e,[{key:"load",value:function(){var e=this;v.a.instrument(this.ctx,"acoustic_grand_piano").then(function(t){e.piano=t})}},{key:"play",value:function(e){this.piano.play(e)}}],[{key:"getInstance",value:function(){return this.Instance||(this.Instance=new e),this.Instance}}]),e}();f.Instance=void 0;var d=window;function m(){var e=Object(c.a)(["\n  position:absolute;\n  background-color: white;\n  width: 30px;\n  height: 10px;\n  border-radius: 15px;\n  transition-duration:5s;\n  transition-timing-function: linear;\n  top: calc(-100vh + 400px);\n  &.isStarted {\n    transform: ",";\n  }\n"]);return m=function(){return e},e}d.AudioContext=d.AudioContext||d.webkitAudioContext;var b,g=function(e){function t(){var e,n;Object(r.a)(this,t);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={isStarted:!1,height:100},n}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.setState({isStarted:!0,height:document.body.scrollHeight-300})}},{key:"render",value:function(){return a.createElement(w,{className:this.state.isStarted?"isStarted":"",height:this.state.height})}}]),t}(a.Component),w=h.a.div(m(),function(e){return"translateY(".concat(e.height,"px)")}),k=n(11),y=n.n(k),O=n(23),j=function(){function e(t,n){Object(r.a)(this,e),this.scale=t,this.octave=n}return Object(o.a)(e,[{key:"IsBlack",value:function(){return this.scale==b.Csharp||this.scale==b.Dsharp||this.scale==b.Fsharp||this.scale==b.Gsharp||this.scale==b.Asharp}}]),e}();!function(e){e.C="C",e.Csharp="C#",e.D="D",e.Dsharp="D#",e.E="E",e.F="F",e.Fsharp="F#",e.G="G",e.Gsharp="G#",e.A="A",e.Asharp="A#",e.B="B",e.None="Nonel"}(b||(b={}));var E=n(24),N=n(12),x=function(){function e(){Object(r.a)(this,e),this.OnSequence=new E.Subject,this.tempos=[],this.bpm=120,this.timer=void 0,this.midi=new N.Midi,this.sequenceNotes=[],this.playNotes=[],this.trackNum=0}return Object(o.a)(e,[{key:"load",value:function(){var e=Object(O.a)(y.a.mark(function e(t){var n,a=arguments;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:0,e.next=3,N.Midi.fromUrl(t);case 3:this.midi=e.sent,this.tempos=this.midi.header.tempos,this.playNotes=this.midi.tracks[n].notes.sort(function(e,t){return e.ticks-t.ticks}),this.sequenceNotes=Object.assign([],this.playNotes),this.trackNum=n;case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"play",value:function(){var e=this,t=f.getInstance().ctx,n=t.currentTime+5;this.timer=setInterval(function(){var a=t.currentTime-n;e.tempos.length>0&&e.tempos[0].ticks/1e3<a&&(e.bpm=e.tempos[0].bpm,e.tempos.shift()),e.sequenceNotes.length>0&&e.sequenceNotes[0].ticks*(120/e.bpm)/1e3-5<a&&(e.OnSequence.onNext(new j(function(e){switch(e){case"C":return b.C;case"C#":return b.Csharp;case"D":return b.D;case"D#":return b.Dsharp;case"E":return b.E;case"F":return b.F;case"F#":return b.Fsharp;case"G":return b.G;case"G#":return b.Gsharp;case"A":return b.A;case"A#":return b.Asharp;case"B":return b.B;default:return b.None}}(e.sequenceNotes[0].pitch),e.sequenceNotes[0].octave)),e.sequenceNotes.shift()),e.playNotes.length>0&&e.playNotes[0].ticks*(120/e.bpm)/1e3<a&&(f.getInstance().play(e.playNotes[0].pitch+e.playNotes[0].octave),e.playNotes.shift())},30)}},{key:"stop",value:function(){this.playNotes=this.midi.tracks[this.trackNum].notes.sort(function(e,t){return e.ticks-t.ticks}),this.sequenceNotes=Object.assign([],this.playNotes),this.tempos=this.midi.header.tempos,clearInterval(this.timer),this.timer=null}}],[{key:"getInstance",value:function(){return this.Instance||(this.Instance=new e),this.Instance}}]),e}();function A(){var e=Object(c.a)(["\n  width: calc(150% / 2);\n  height: 200px;\n  position: absolute;\n  background-color: ",";\n  background-color: black;\n  left: calc(125%/2);\n  z-index: 20;\n"]);return A=function(){return e},e}function C(){var e=Object(c.a)(["\n  width: calc(100% / 7);\n  height: 300px;\n  box-sizing: border-box;\n  background-color: ",";\n  border: 1px solid black;\n  position: relative;\n"]);return C=function(){return e},e}function I(){var e=Object(c.a)(["\n"]);return I=function(){return e},e}x.Instance=void 0;var S=function(e){function t(){var e,n;Object(r.a)(this,t);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={notes:[],isActive:!1},n}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;x.getInstance().OnSequence.where(function(t){return t.scale===e.props.scale.scale&&t.octave===e.props.scale.octave}).subscribe(this.OnNoteCreate.bind(this))}},{key:"render",value:function(){var e=this,t=this.props.scale.IsBlack()?F:D;return a.createElement(t,{isActive:this.state.isActive,onClick:function(t){return e.onClickKey(t)}},this.state.notes.map(function(t){return a.createElement(g,{scale:e.props.scale})}),this.props.children)}},{key:"onClickKey",value:function(e){e.stopPropagation(),f.getInstance().play(this.props.scale.scale.toString()+this.props.scale.octave.toString())}},{key:"OnNoteCreate",value:function(e){var t=this,n=Object.assign([],this.state.notes);n.push(1),this.setState({notes:n}),setTimeout(function(){t.setState({isActive:!0}),setTimeout(function(){t.setState({isActive:!1})},500)},5e3)}}]),t}(a.Component),q=h.a.div(I()),D=Object(h.a)(q)(C(),function(e){return e.isActive?"#91fff6":"white"}),F=Object(h.a)(q)(A(),function(e){return e.isActive?"#68777a":"black"}),G=function(e){return a.createElement("div",{style:{display:"flex",flexWrap:"wrap",width:600,minWidth:400,backgroundColor:"white"}},a.createElement(S,{scale:new j(b.C,e.octave)},a.createElement(S,{scale:new j(b.Csharp,e.octave)})),a.createElement(S,{scale:new j(b.D,e.octave)},a.createElement(S,{scale:new j(b.Dsharp,e.octave)})),a.createElement(S,{scale:new j(b.E,e.octave)}),a.createElement(S,{scale:new j(b.F,e.octave)},a.createElement(S,{scale:new j(b.Fsharp,e.octave)})),a.createElement(S,{scale:new j(b.G,e.octave)},a.createElement(S,{scale:new j(b.Gsharp,e.octave)})),a.createElement(S,{scale:new j(b.A,e.octave)},a.createElement(S,{scale:new j(b.Asharp,e.octave)})),a.createElement(S,{scale:new j(b.B,e.octave)}))};function W(){var e=Object(c.a)(["\n  display: flex;\n  flexWrap: wrap; \n  height: 300px;\n  background-color: #222;\n  padding-top: calc(100vh - 400px);\n  width: 100%;\n  overflow-x: auto;\n"]);return W=function(){return e},e}var B=function(e){function t(e){var n;return Object(r.a)(this,t),n=Object(s.a)(this,Object(u.a)(t).call(this,e)),f.getInstance().load(),x.getInstance().load("/WebPianoSequencer/menuett.mid",2).then(function(){x.getInstance().play()}),n}return Object(l.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return a.createElement("div",{className:"App"},a.createElement(T,null,a.createElement(G,{octave:3}),a.createElement(G,{octave:4}),a.createElement(G,{octave:5}),a.createElement(G,{octave:6})))}}]),t}(a.Component),T=h.a.div(W()),M=(n(62),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)));function P(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}i.render(a.createElement(B,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/WebPianoSequencer",window.location.toString()).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("/WebPianoSequencer","/service-worker.js");M?(!function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):P(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):P(e)})}}()}},[[27,1,2]]]);
//# sourceMappingURL=main.d10bfbeb.chunk.js.map